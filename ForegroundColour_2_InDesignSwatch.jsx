// Send foreground colour to Indesign.// This script will create a CMYK swatch in InDesign based on the foreground colour in Photoshop// Bruno Herfst 2014// Version 1.0// Get the CMYK values from PSvar fc = app.foregroundColor;var foreGroundCMYK = [fc.cmyk.cyan,fc.cmyk.magenta,fc.cmyk.yellow,fc.cmyk.black];// The script to create a swatch in InDesignfunction addCMYKtoSwatch(c,m,y,k) {	    if (app.documents.length <= 0) {        alert("Open a cover before sending colours.");        exit();    }    function doRound(num, roundDec) {		var roundMulit = Math.pow(10,roundDec);		return Math.round(num*roundMulit)/roundMulit;	}     var myDocument = app.activeDocument;    var myColor    = myDocument.colors.add();        myColor.properties = {		model: ColorModel.PROCESS,		space: ColorSpace.CMYK,		colorValue: [doRound(c,2),doRound(m,2),doRound(y,2),doRound(k,2)]	};	alert("Added " + myColor.properties.name + " to swatches!");}// the BridgeTalk Objectvar bt = new BridgeTalk();// the communication targetbt.target = "indesign";// The script to be executed as a Stringvar message = addCMYKtoSwatch.toString();    message += "\n addCMYKtoSwatch(" + foreGroundCMYK.toString() + ");";// assign to the object's body the messagebt.body = message; // send the message to the target appbt.send();